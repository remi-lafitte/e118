#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
ls<-list(cat(txt$full, sep = "\n"))
ls
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
ls<-list(txt$full)
capture.output(ls)
cat(ls)
capture.output(ls)
cat(capture.output(ls))
cat(capture.output(ls), sep ="\n")
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
ls<-list(noquote(txt$full))
ls
cat(capture.output(ls), sep ="\n")
aov4_txt<- function(model){
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
ls<-list(noquote(txt$full))
# txt<-txt[txt$Parameter == effect,]
return(list(full = cat(capture.output(ls), sep ="\n"), txt  = txt))
}
anova_report(model = model, data = d, output = "html", open=T)
aov4_txt<- function(model){
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
return(list(full = noquote(txt$full), txt  = txt))
}
t
anova_report(model = model, data = d, output = "html", open=T)
aov4_txt(model)$full
anova_report(model = model, data = d, output = "html", open=T)
x$Anova
aov4_txt(model)$full
print(aov4_txt(model)$full)
anova_report(model = model, data = d, output = "html", open=T)
aov4_txt(model)$full,
anova_report(model = model, data = d, output = "html", open=T)
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
txt$full
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
paste(txt$full)
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
paste(as.matrix(txt$full))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
paste(t(as.matrix(txt$full)))
as.matrix(txt$full)
t(as.matrix(txt$full))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
paste0(t(as.matrix(txt$full)))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
w<-paste0(t(as.matrix(txt$full)))
w
str(w)
paste(w,collapse="")
test<-paste(w,collapse="")
aov4_txt<- function(model){
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
w<-paste0(t(as.matrix(txt$full)))
test<-paste(w,collapse="")
return(list(full =txt$full, txt  = txt, test = test))
}
anova_report(model = model, data = d, output = "html", open=T)
anova_report(model = model, data = d, output = "html", open=T)
aov4_txt<- function(model){
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci, sep = "")) %>%
mutate(rmd= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
w<-paste0(t(as.matrix(txt$rmd)))
rmd<-paste(w,collapse="")
return(list(full =txt$full, txt  = txt, rmd = rmd))
}
anova_report(model = model, data = d, output = "html", open=T)
anova_report(model = model, data = d, output = "word", open=T)
aov4_txt<- function(model){
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci, sep = "")) %>%
mutate(html= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(docx= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"  ", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
w<-paste0(t(as.matrix(txt$html)))
html<-paste(w,collapse="")
w<-paste0(t(as.matrix(txt$docx)))
docx<-paste(w,collapse="")
return(list(full =txt$full, txt  = txt, html = html, docx = docx))
}
anova_report(model = model, data = d, output = "word", open=T)
anova_report(model = model, data = d, output = "word", open=T)
aov4_txt<- function(model){
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci, sep = "")) %>%
mutate(html= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(docx= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"\newline", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
w<-paste0(t(as.matrix(txt$html)))
html<-paste(w,collapse="")
w<-paste0(t(as.matrix(txt$docx)))
docx<-paste(w,collapse="")
return(list(full =txt$full, txt  = txt, html = html, docx = docx))
}
anova_report(model = model, data = d, output = "word", open=T)
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci, sep = "")) %>%
mutate(html= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(docx= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"\newline", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
w<-paste0(t(as.matrix(txt$html)))
html<-paste(w,collapse="")
html
w<-paste0(t(as.matrix(txt$docx)))
docx<-paste(w,collapse="")
docx
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci, sep = "")) %>%
mutate(html= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(docx= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci," \newline ", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
w<-paste0(t(as.matrix(txt$html)))
html<-paste(w,collapse="")
w<-paste0(t(as.matrix(txt$docx)))
docx
aov4_txt<- function(model){
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci, sep = "")) %>%
mutate(html= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(docx= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci," \newline ", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
w<-paste0(t(as.matrix(txt$html)))
html<-paste(w,collapse="")
w<-paste0(t(as.matrix(txt$docx)))
docx<-paste(w,collapse="")
return(list(full =txt$full, txt  = txt, html = html, docx = docx))
}
anova_report(model = model, data = d, output = "word", open=T)
anova_report(model = model, data = d, output = "word", open=T)
aov4_txt<- function(model){
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci, sep = "")) %>%
mutate(html= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(docx= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"\n", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
w<-paste0(t(as.matrix(txt$html)))
html<-paste(w,collapse="")
w<-paste0(t(as.matrix(txt$docx)))
docx<-paste(w,collapse="")
return(list(full =txt$full, txt  = txt, html = html, docx = docx))
}
anova_report(model = model, data = d, output = "word", open=T)
anova_report(model = model, data = d, output = "word", open=T)
aov4_txt<- function(model){
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci, sep = "")) %>%
mutate(html= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(docx= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"  <br>  ", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
w<-paste0(t(as.matrix(txt$html)))
html<-paste(w,collapse="")
w<-paste0(t(as.matrix(txt$docx)))
docx<-paste(w,collapse="")
return(list(full =txt$full, txt  = txt, html = html, docx = docx))
}
docx<-paste(w,collapse=" ")
docx
aov4_txt<- function(model){
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci, sep = "")) %>%
mutate(html= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(docx= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"  <br>  ", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
w<-paste0(t(as.matrix(txt$html)))
html<-paste(w,collapse="")
w<-paste0(t(as.matrix(txt$docx)))
docx<-paste(w,collapse=" ")
return(list(full =txt$full, txt  = txt, html = html, docx = docx))
}
anova_report(model = model, data = d, output = "word", open=T)
aov4_txt<- function(model){
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<-
table %>%
dplyr::group_by(Parameter) %>%
mutate(p = p_txt(Pr..F.)) %>%
mutate(F = paste("*F*(",num.Df, ", ",den.Df,") = ",F, sep = "")) %>%
mutate(ges = paste("$\\hat{\\eta}^2_G$ = ",round(ges,2))) %>%
mutate(pes = paste("$\\hat{\\eta}^2_p$ = ",round(Eta_Sq_partial,2))) %>%
mutate(pes_ci =  paste("95% CI [",round(CI_low,2),", ",round(CI_high,2),"]", sep = "")) %>%
mutate(pes_full =  paste(pes,", ", pes_ci, sep = "")) %>%
mutate(full= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci, sep = "")) %>%
mutate(html= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"<br/><br/>", sep = "")) %>%
mutate(docx= paste(F,", ",p,", ", ges,", ", pes,", ", pes_ci,"\\", sep = "")) %>%
mutate(small= paste(F,", ",p, sep = ""))
#
#     rownames(txt)<- txt$Parameter
#
#     list <- setNames(split(txt, seq(nrow(txt))), rownames(txt))
# txt<-txt[txt$Parameter == effect,]
w<-paste0(t(as.matrix(txt$html)))
html<-paste(w,collapse="")
w<-paste0(t(as.matrix(txt$docx)))
docx<-paste(w,collapse=" ")
return(list(full =txt$full, txt  = txt, html = html, docx = docx))
}
anova_report(model = model, data = d, output = "word", open=T)
