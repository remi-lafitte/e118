library(afex)
library(effectsize)
library(dplyr)
library(magrittr)
anova_txt<- function(model_aov_4){
# library(afex)
# library(effectsize)
# library(dplyr)
# library(magrittr)
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
rownames_to_column("Parameter") %>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
table<- table %>%
mutate(
txt= paste("*F*(",
num.Df,
", ",
den.Df,
") = ",
F,
", *p* < ",
Pr..F.,
", ges = ",
ges,
", pes = ",
Eta_Sq_partial,
", 95% CI [",
CI_low,
", ",
CI_high,
"]",
sep = "")
)
return(list(anova = table))
}
data(mtcars)
data<-mtcars %>% mutate(ID = 1:nrow(.))
model<-afex::aov_4(mpg~ vs * am + (1|ID), data)
result<-anova_txt(model = model)
anova_txt<- function(model_aov_4){
# library(afex)
# library(effectsize)
# library(dplyr)
# library(magrittr)
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
table<- table %>%
mutate(
txt= paste("*F*(",
num.Df,
", ",
den.Df,
") = ",
F,
", *p* < ",
Pr..F.,
", ges = ",
ges,
", pes = ",
Eta_Sq_partial,
", 95% CI [",
CI_low,
", ",
CI_high,
"]",
sep = "")
)
return(list(anova = table))
}
anova_txt(model = model)
result<-anova_txt(model = model)
result$anova$txt
anova_txt<- function(model_aov_4){
# library(afex)
# library(effectsize)
# library(dplyr)
# library(magrittr)
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<- table %>%
mutate(
txt= paste("*F*(",
num.Df,
", ",
den.Df,
") = ",
F,
", *p* < ",
Pr..F.,
", ges = ",
ges,
", pes = ",
Eta_Sq_partial,
", 95% CI [",
CI_low,
", ",
CI_high,
"]",
sep = "")
)
return(txt)
}
anova_txt(model = model)
result<-anova_txt(model = model)
result$txt
anova_txt<- function(model_aov_4, effect = ""){
# library(afex)
# library(effectsize)
# library(dplyr)
# library(magrittr)
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<- table %>%
mutate(
txt= paste("*F*(",
num.Df,
", ",
den.Df,
") = ",
F,
", *p* < ",
Pr..F.,
", ges = ",
ges,
", pes = ",
Eta_Sq_partial,
", 95% CI [",
CI_low,
", ",
CI_high,
"]",
sep = "")
)
txt<-txt[txt$Parameter == effect,]
return(txt)
}
anova_txt(model = model)
anova_txt(model = model, effect = "intra")
model
anova_txt(model = model, effect = "vs")
anova_txt<- function(model_aov_4, effect = "T"){
# library(afex)
# library(effectsize)
# library(dplyr)
# library(magrittr)
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<- table %>%
mutate(
txt= paste("*F*(",
num.Df,
", ",
den.Df,
") = ",
F,
", *p* < ",
Pr..F.,
", ges = ",
ges,
", pes = ",
Eta_Sq_partial,
", 95% CI [",
CI_low,
", ",
CI_high,
"]",
sep = "")
)
txt<-txt[txt$Parameter == effect,]
return(txt)
}
anova_txt(model = model, effect = "vs")
anova_txt(model = model)
model
model$Effect
effectsize::eta_squared(model, partial = TRUE, ci = 0.9)
x<-effectsize::eta_squared(model, partial = TRUE, ci = 0.9)
x$Parameter
anova_txt<- function(model_aov_4, effect = F){
# library(afex)
# library(effectsize)
# library(dplyr)
# library(magrittr)
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<- table %>%
mutate(
txt= paste("*F*(",
num.Df,
", ",
den.Df,
") = ",
F,
", *p* < ",
Pr..F.,
", ges = ",
ges,
", pes = ",
Eta_Sq_partial,
", 95% CI [",
CI_low,
", ",
CI_high,
"]",
sep = "")
)
filter<-if_else(effect == F, txt$Parameter, effect)
txt<-txt[txt$Parameter == c(filter),]
return(txt)
}
anova_txt(model = model, effect = "vs")
anova_txt<- function(model_aov_4, effect = F){
# library(afex)
# library(effectsize)
# library(dplyr)
# library(magrittr)
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<- table %>%
mutate(
txt= paste("*F*(",
num.Df,
", ",
den.Df,
") = ",
F,
", *p* < ",
Pr..F.,
", ges = ",
ges,
", pes = ",
Eta_Sq_partial,
", 95% CI [",
CI_low,
", ",
CI_high,
"]",
sep = "")
)
filter<-if_else(effect == F, txt$Parameter, effect)
txt<-txt[txt$Parameter == filter,]
return(txt)
}
anova_txt(model = model, effect = "vs")
?if
)
if
x$Parameter
c(x$Parameter)
anova_txt<- function(model_aov_4, effect = txt$Parameter){
# library(afex)
# library(effectsize)
# library(dplyr)
# library(magrittr)
pes<-
effectsize::eta_squared(model, partial = TRUE, ci = 0.9) %>%
data.frame %>%
mutate_if(is.numeric, round, digits=3)
table<-
model$anova_table %>%
data.frame %>%
mutate(Parameter = rownames(.))%>%
mutate_if(is.numeric, round, digits=2) %>%
inner_join(., pes, by = "Parameter")
txt<- table %>%
mutate(
txt= paste("*F*(",
num.Df,
", ",
den.Df,
") = ",
F,
", *p* < ",
Pr..F.,
", ges = ",
ges,
", pes = ",
Eta_Sq_partial,
", 95% CI [",
CI_low,
", ",
CI_high,
"]",
sep = "")
)
txt<-txt[txt$Parameter == effect,]
return(txt)
}
anova_txt(model = model)
anova_txt(model = model, effect = "vs")
